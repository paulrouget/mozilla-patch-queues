# HG changeset patch
# Parent 0f8ea3826bf79f3b6c09b4da14abdd76200004ff
Bug 749974 - Items in Developer tools menu have inconsistent check state

diff --git a/browser/devtools/highlighter/inspector.jsm b/browser/devtools/highlighter/inspector.jsm
--- a/browser/devtools/highlighter/inspector.jsm
+++ b/browser/devtools/highlighter/inspector.jsm
@@ -447,25 +447,30 @@ InspectorUI.prototype = {
                                INSPECTOR_NOTIFICATIONS.OPENED,
                                false);
     }
     // Start initialization.
     this.browser = this.tabbrowser.selectedBrowser;
     this.win = this.browser.contentWindow;
     this.winID = this.getWindowID(this.win);
     this.toolbar = this.chromeDoc.getElementById("inspector-toolbar");
+
+    // Update menus:
     this.inspectMenuitem = this.chromeDoc.getElementById("Tools:Inspect");
-    this.inspectToolbutton =
-      this.chromeDoc.getElementById("inspector-inspect-toolbutton");
+    this.inspectToolbutton = this.chromeDoc.getElementById("inspector-inspect-toolbutton");
+    this.inspectAppMenuitem = this.chromeDoc.getElementById("appmenu_pageInspect");
+
+    this.inspectMenuitem.setAttribute("checked", "true");
+    this.inspectToolbutton.setAttribute("checked", "true");
+    if (this.inspectAppMenuitem) this.inspectAppMenuitem.setAttribute("checked", "true");
 
     this.chromeWin.Tilt.setup();
 
     this.treePanel = new TreePanel(this.chromeWin, this);
     this.toolbar.hidden = false;
-    this.inspectMenuitem.setAttribute("checked", true);
 
     // initialize the HTML Breadcrumbs
     this.breadcrumbs = new HTMLBreadcrumbs(this);
 
     this.isDirty = false;
 
     this.progressListener = new InspectorProgressListener(this);
 
@@ -643,16 +648,19 @@ InspectorUI.prototype = {
       this.breadcrumbs = null;
     }
 
     delete this._currentInspector;
     if (!aKeepInspector)
       this.store.deleteInspector(this.winID);
 
     this.inspectMenuitem.removeAttribute("checked");
+    this.inspectToolbutton.removeAttribute("checked");
+    if (this.inspectAppMenuitem) this.inspectAppMenuitem.removeAttribute("checked");
+
     this.browser = this.win = null; // null out references to browser and window
     this.winID = null;
     this.selection = null;
     this.closing = false;
     this.isDirty = false;
 
     delete this.treePanel;
     delete this.stylePanel;
@@ -670,18 +678,16 @@ InspectorUI.prototype = {
    */
   startInspecting: function IUI_startInspecting()
   {
     // if currently editing an attribute value, starting
     // "live inspection" mode closes the editor
     if (this.treePanel && this.treePanel.editingContext)
       this.treePanel.closeEditor();
 
-    this.inspectToolbutton.checked = true;
-
     this.inspecting = true;
     this.highlighter.unlock();
     this._notifySelected();
     this._currentInspector._emit("unlocked");
   },
 
   _notifySelected: function IUI__notifySelected(aFrom)
   {
@@ -695,18 +701,16 @@ InspectorUI.prototype = {
    *        Prevent scroll in the HTML tree?
    */
   stopInspecting: function IUI_stopInspecting(aPreventScroll)
   {
     if (!this.inspecting) {
       return;
     }
 
-    this.inspectToolbutton.checked = false;
-
     this.inspecting = false;
     if (this.highlighter.getNode()) {
       this.select(this.highlighter.getNode(), true, !aPreventScroll);
     } else {
       this.select(null, true, true);
     }
 
     this.highlighter.lock();
